---
title: "Rails â€“ ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒã‚¹ãƒˆã™ã‚‹ã¨ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒåŠ¹ã‹ãªã„"
emoji: "ğŸ–¥"
type: "tech"
topics: ["rails"]
published: true
published_at: 2024-01-02 16:53
---

# ä¾‹


å†…å´ã§ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’å®Ÿè¡Œã—ã¦ã‚‚ã‚³ãƒŸãƒƒãƒˆã•ã‚Œã¦ã—ã¾ã†ã‚ˆã†ã 

```rb
p Example.count

ApplicationRecord.transaction do
  ApplicationRecord.transaction do
    Example.create
  end

  raise ActiveRecord::Rollback
end

p Example.count # ã‚«ã‚¦ãƒ³ãƒˆãŒå¢—ãˆã¦ã—ã¾ã†
```

å˜ç´”ãªã‚³ãƒ¼ãƒ‰ã§ã‚ã‚Œã°æ°—ã¥ããŒã€ã‚³ãƒ¼ãƒ‰ãŒå…¥ã‚Šçµ„ã‚“ã§ã„ã‚‹å ´åˆã¯æ³¨æ„

# å¤–å´ã®åˆ¶å¾¡ã§å›é¿

å¤–å´ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã§  `joinable: false` ã‚’æŒ‡å®šã™ã‚‹ã¨ã€å¤–å´ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã¸ã®åˆæµã‚’é˜²ã’ã‚‹ã‚ˆã†ã 

```rb
p Example.count

ApplicationRecord.transaction(joinable: false) do
  ApplicationRecord.transaction do

  Example.create


  raise ActiveRecord::Rollback
  end
end

p Example.count
```

# å›é¿ - å†…å´ã®åˆ¶å¾¡

å†…å´ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã§ `requires_new: true` ã‚’æŒ‡å®šã™ã‚‹ã¨ã€å¤–å´ã¨ã®åˆæµã‚’é˜²ã’ã‚‹ã‚ˆã†ã 

```rb
p Example.count

ApplicationRecord.transaction do
  ApplicationRecord.transaction(requires_new: true) do

  Example.create


  raise ActiveRecord::Rollback
  end
end

p Example.count
```

# å‚è€ƒ

[ActiveRecord - ãƒã‚¹ãƒˆã—ãŸãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®è½ã¨ã—ç©´ #Rails](https://qiita.com/jnchito/items/930575c18679a5dbe1a0)


[Railsã«ãŠã‘ã‚‹ãƒã‚¹ãƒˆã—ãŸtransactionã®æŒ™å‹•](https://zenn.dev/merda/articles/cbe2fdfd97ee75)



# ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒ³ãƒãƒ¼å‹Ÿé›†


ä½•ã‹è³ªå•ã€æ‚©ã¿äº‹ã€ç›¸è«‡ãªã©ã‚ã‚Œã°LINEã‚ªãƒ¼ãƒ—ãƒ³ãƒãƒ£ãƒƒãƒˆã‚‚ã”åˆ©ç”¨ãã ã•ã„ã€‚

https://line.me/ti/g2/eEPltQ6Tzh3pYAZV8JXKZqc7PJ6L0rpm573dcQ


# Twitter

https://twitter.com/YumaInaura


# å…¬é–‹æ—¥æ™‚

2023-11-20
