---
title: "AWS Terraform ã®ã‚¨ãƒ©ãƒ¼ - CloudWatch ã®ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã«Lambdaå®Ÿè¡Œæ¨©é™ã‚’ä¸ãˆã‚‹"
emoji: "ğŸ–¥"
type: "tech"
topics: ["aws", "terraform"]
published: true
published_at: 2023-10-07 14:08
---

# ã‚¨ãƒ©ãƒ¼

> Error: putting CloudWatch Logs Subscription Filter (****):
>  InvalidParameterException: Could not execute the lambda function. Make sure you have given CloudWatch Logs permission to execute your function.

# è§£æ±º

aws_lambda_permissionã®æŒ‡å®šã§ã€ã‚½ãƒ¼ã‚¹ã¨ãªã‚‹CloudWatchã®ãƒ­ã‚°ã®ARNã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰æŒ‡å®šãŒå¿…è¦ã ã£ãŸã¿ãŸã„ã 

Terraformå…¬å¼ã‚ˆã‚Š

```tf
resource "aws_lambda_permission" "logging" {
  action        = "lambda:InvokeFunction"
  function_name = aws_lambda_function.logging.function_name
  principal     = "logs.<REGION>.amazonaws.com"
  source_arn    = "${aws_cloudwatch_log_group.default.arn}:*"
}
```




# ç¢ºèªæ‰‹æ®µ

AWSãƒãƒãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã€CloudWatchã®ãƒ­ã‚°ã‚’é¸ã‚“ã§ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ç™»éŒ²ãƒ»Lambdaã¸ã®é–¢é€£ä»˜ã‘ã‚’ãŠã“ãªã†ã¨ã€Lambdaã®ç”»é¢ã§ãƒªã‚½ãƒ¼ã‚¹ãƒ™ãƒ¼ã‚¹ã®è¨±å¯çŠ¶æ…‹ã‚’è¦‹ã‚‰ã‚Œã‚‹

Lambdaé–¢æ•° > è¨­å®š > ãƒªã‚½ãƒ¼ã‚¹ãƒ™ãƒ¼ã‚¹ã®ãƒãƒªã‚·ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆ 

ã“ã®è¨­å®šã‚’Terraformã§ã‚‚è¸è¥²ã—ãŸ


# å‚è€ƒ


Lambda ã§ã®ãƒªã‚½ãƒ¼ã‚¹ãƒ™ãƒ¼ã‚¹ã®ãƒãƒªã‚·ãƒ¼ã®ä½¿ç”¨
https://docs.aws.amazon.com/ja_jp/lambda/latest/dg/access-control-resource-based.html

Terraformå…¬å¼

https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_permission

# ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒ³ãƒãƒ¼å‹Ÿé›†


ä½•ã‹è³ªå•ã€æ‚©ã¿äº‹ã€ç›¸è«‡ãªã©ã‚ã‚Œã°LINEã‚ªãƒ¼ãƒ—ãƒ³ãƒãƒ£ãƒƒãƒˆã‚‚ã”åˆ©ç”¨ãã ã•ã„ã€‚

https://line.me/ti/g2/eEPltQ6Tzh3pYAZV8JXKZqc7PJ6L0rpm573dcQ


# Twitter

https://twitter.com/YumaInaura


# å…¬é–‹æ—¥æ™‚

2023-10-03
